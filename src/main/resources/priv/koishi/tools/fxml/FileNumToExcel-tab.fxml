<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.collections.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<AnchorPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
            fx:controller="priv.koishi.tools.Controller.FileNumToExcelController">
    <VBox fx:id="vbox_Num" spacing="10" AnchorPane.topAnchor="10">
        <HBox spacing="10">
            <Label prefHeight="20" text="文件夹查询设置:" />
            <ChoiceBox fx:id="directoryNameType_Num" prefHeight="20" prefWidth="140">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="只查询文件" />
                        <String fx:value="文件和文件夹都查询" />
                        <String fx:value="只查询文件夹" />
                    </FXCollections>
                </items>
                <value>
                    <String fx:value="只查询文件" />
                </value>
            </ChoiceBox>
            <Label prefHeight="20" text="隐藏文件查询设置:" />
            <ChoiceBox fx:id="hideFileType_Num" prefHeight="20" prefWidth="120">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="不查询隐藏文件" />
                        <String fx:value="是否隐藏都查询" />
                        <String fx:value="只查询隐藏文件" />
                    </FXCollections>
                </items>
                <value>
                    <String fx:value="不查询隐藏文件" />
                </value>
            </ChoiceBox>
            <CheckBox fx:id="recursion_Num" prefHeight="20" style="-fx-cursor: hand" text="递归查询" />
            <CheckBox fx:id="showFileType_Num" onAction="#handleCheckBoxAction" prefHeight="20" style="-fx-cursor: hand" text="显示文件拓展名" />
            <CheckBox fx:id="openDirectory_Num" prefHeight="20" selected="true" style="-fx-cursor: hand" text="导出后打开文件夹" />
            <CheckBox fx:id="openFile_Num" prefHeight="20" style="-fx-cursor: hand" text="导出后打开excel文件" />
        </HBox>

        <HBox spacing="10">
            <Label prefHeight="20" text="导出excel文件名称:" />
            <TextField fx:id="excelName_Num" onKeyTyped="#nameHandleKeyTyped" prefHeight="20" prefWidth="100" />
            <Label prefHeight="20" text="excel表名称:" />
            <TextField fx:id="sheetOutName_Num" onKeyTyped="#sheetHandleKeyTyped" prefHeight="20" prefWidth="100" />
            <Label prefHeight="20" text="文件名称分割符:" />
            <TextField fx:id="subCode_Num" onKeyTyped="#subHandleKeyTyped" prefHeight="20" prefWidth="100" />
            <Label prefHeight="20" text="导出excel文件类型:" />
            <ChoiceBox fx:id="excelType_Num" prefHeight="20" prefWidth="80">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value=".xlsx" />
                        <!--                    <String fx:value=".xls"/>-->
                    </FXCollections>
                </items>
                <value>
                    <String fx:value=".xlsx" />
                </value>
            </ChoiceBox>
        </HBox>

        <HBox spacing="10">
            <Label prefHeight="20" text="导出预留行:" />
            <TextField fx:id="startRow_Num" onKeyTyped="#rowHandleKeyTyped" prefHeight="20" prefWidth="50" />
            <Label prefHeight="20" text="导出预留列:" />
            <TextField fx:id="startCell_Num" onKeyTyped="#cellHandleKeyTyped" prefHeight="20" prefWidth="50" />
            <Label prefHeight="20" text="读取预留行:" />
            <TextField fx:id="readRow_Num" onKeyTyped="#readRowHandleKeyTyped" prefHeight="20" prefWidth="50" />
            <Label prefHeight="20" text="读取预留列:" />
            <TextField fx:id="readCell_Num" onKeyTyped="#readCellHandleKeyTyped" prefHeight="20" prefWidth="50" />
            <Label prefHeight="20" text="读取行数:" />
            <TextField fx:id="maxRow_Num" onKeyTyped="#maxRowHandleKeyTyped" prefHeight="20" prefWidth="50" />
            <Label prefHeight="20" text="需要识别的文件后缀名:" />
            <TextField fx:id="filterFileType_Num" onKeyTyped="#filterHandleKeyTyped" prefHeight="20" prefWidth="150" />
        </HBox>

        <HBox spacing="10">
            <Button fx:id="fileButton_Num" onAction="#inDirectoryButton" style="-fx-cursor: hand" text="选择要统计的文件夹" />
            <Label fx:id="inPath_Num" prefHeight="20" prefWidth="300" style="-fx-font-size: 15px;" />
            <Button onAction="#exportPath" style="-fx-cursor: hand" text="选择导出文件夹位置" />
            <Label fx:id="outPath_Num" prefHeight="20" style="-fx-font-size: 15px;" />
        </HBox>

        <HBox spacing="10">
            <Button onAction="#getExcelPath" style="-fx-cursor: hand" text="选择excel模板位置" />
            <Label fx:id="excelPath_Num" prefHeight="20" style="-fx-font-size: 15px;" />
        </HBox>

        <HBox spacing="10">
            <Button fx:id="reSelectButton_Num" onAction="#reSelect" style="-fx-cursor: hand" text="重新查询" />
            <Button fx:id="clearButton_Num" onAction="#removeAll" style="-fx-cursor: hand" text="清空列表" />
            <Button fx:id="exportButton_Num" onAction="#exportAll" style="-fx-cursor: hand" text="开始导出" />
            <Label fx:id="exportTypeLabel_Num" prefHeight="20" text="导出excel文件内容:" />
            <ChoiceBox fx:id="exportType_Num" prefHeight="20" prefWidth="120">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="文件数量" />
                        <String fx:value="文件名称" />
                        <String fx:value="文件数量和名称" />
                    </FXCollections>
                </items>
                <value>
                    <String fx:value="文件数量" />
                </value>
            </ChoiceBox>
            <Label fx:id="fileNumber_Num" prefHeight="20" text="列表为空" alignment="CENTER_RIGHT" />
        </HBox>

        <TableView fx:id="tableView_Num" onDragDropped="#handleDrop" onDragOver="#acceptDrop">
            <placeholder>
                <Label text="拖拽 或点击 选择excel模板位置 按钮向列表添加文件" />
            </placeholder>

            <columns>
                <TableColumn fx:id="groupId_Num" text="序号" />
                <TableColumn fx:id="groupName_Num" text="分组名称" />
                <TableColumn fx:id="groupNumber_Num" text="文件数量" />
                <TableColumn fx:id="fileName_Num" text="文件名称" />
            </columns>
        </TableView>

        <Label fx:id="log_Num" prefHeight="20"/>
    </VBox>
</AnchorPane>
