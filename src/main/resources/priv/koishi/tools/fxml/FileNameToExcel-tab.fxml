<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.collections.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>

<AnchorPane fx:id="anchorPane_Name" xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml" stylesheets="@../css/Styles.css"
            fx:controller="priv.koishi.tools.Controller.FileNameToExcelController">
    <VBox spacing="10" AnchorPane.topAnchor="10" AnchorPane.leftAnchor="30">
        <HBox spacing="10">
            <Label prefHeight="25" text="文件夹查询设置:"/>
            <ChoiceBox fx:id="directoryNameType_Name" prefHeight="25" prefWidth="140" style="-fx-cursor: hand">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="只查询文件"/>
                        <String fx:value="文件和文件夹都查询"/>
                        <String fx:value="只查询文件夹"/>
                    </FXCollections>
                </items>
                <value>
                    <String fx:value="只查询文件"/>
                </value>
            </ChoiceBox>

            <Label prefHeight="25" text="隐藏文件查询设置:"/>
            <ChoiceBox fx:id="hideFileType_Name" prefHeight="20" prefWidth="120" style="-fx-cursor: hand">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="不查询隐藏文件"/>
                        <String fx:value="是否隐藏都查询"/>
                        <String fx:value="只查询隐藏文件"/>
                    </FXCollections>
                </items>
                <value>
                    <String fx:value="不查询隐藏文件"/>
                </value>
            </ChoiceBox>

            <CheckBox fx:id="recursion_Name" prefHeight="25" style="-fx-cursor: hand" text="递归查询"/>
            <CheckBox fx:id="showFileType_Name" onAction="#handleCheckBoxAction" prefHeight="25" style="-fx-cursor: hand" text="显示文件拓展名"/>
            <CheckBox fx:id="exportTitle_Name" prefHeight="25" selected="true" style="-fx-cursor: hand" text="导出表头"/>
            <CheckBox fx:id="exportFullList_Name" prefHeight="25" selected="true" style="-fx-cursor: hand" text="导出完整数据"/>
        </HBox>

        <HBox spacing="10">
            <Label prefHeight="25" text="导出excel文件名称:"/>
            <TextField fx:id="excelName_Name" prefHeight="20" prefWidth="160"/>

            <Label prefHeight="25" text="excel表名称:"/>
            <TextField fx:id="sheetName_Name" prefHeight="20" prefWidth="160"/>

            <Label fx:id="excelTypeLabel_Name" prefHeight="25" text="导出excel文件类型:"/>
            <ChoiceBox fx:id="excelType_Name" prefHeight="20" prefWidth="60" style="-fx-cursor: hand">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value=".xlsx"/>
                        <String fx:value=".xls"/>
                    </FXCollections>
                </items>
                <value>
                    <String fx:value=".xlsx"/>
                </value>
            </ChoiceBox>

            <CheckBox fx:id="openDirectory_Name" prefHeight="25" selected="true" style="-fx-cursor: hand" text="导出后打开文件夹"/>
            <CheckBox fx:id="openFile_Name" prefHeight="25" style="-fx-cursor: hand" text="导出后打开excel文件"/>
        </HBox>

        <HBox spacing="10">
            <Label prefHeight="25" text="导出预留行:"/>
            <TextField fx:id="startRow_Name" prefHeight="20" prefWidth="50" promptText="0"/>

            <Label prefHeight="25" text="导出预留列:"/>
            <TextField fx:id="startCell_Name" prefHeight="20" prefWidth="50"/>

            <Label prefHeight="25" text="需要识别的文件后缀名:"/>
            <TextField fx:id="filterFileType_Name" prefHeight="20" prefWidth="300"/>
        </HBox>

        <HBox spacing="10">
            <Button fx:id="fileButton_Name" onAction="#inDirectoryButton" style="-fx-cursor: hand" text="选择要读取的文件夹"/>
            <Label fx:id="inPath_Name" prefHeight="25" prefWidth="300" style="-fx-font-size: 15px;"/>

            <Button fx:id="outPathButton_Name" onAction="#exportPath" style="-fx-cursor: hand" text="选择导出文件夹位置"/>
            <Label fx:id="outPath_Name" prefHeight="25" style="-fx-font-size: 15px;"/>
        </HBox>

        <HBox spacing="10">
            <Button fx:id="excelPathButton_Name" onAction="#getExcelPath" style="-fx-cursor: hand" text="选择excel模板位置"/>
            <Label fx:id="excelPath_Name" prefHeight="25" style="-fx-font-size: 15px;"/>

            <Button fx:id="removeExcelButton_Name" onAction="#removeExcelPath" prefHeight="20"
                    styleClass="delete-button-style" visible="false">
                <graphic>
                    <ImageView>
                        <Image url="@../icon/Trash.png"/>
                    </ImageView>
                </graphic>
            </Button>
        </HBox>

        <HBox fx:id="fileNumberHBox_Name" spacing="10">
            <Button fx:id="reselectButton_Name" onAction="#reselect" styleClass="cadetblue-button" text="重新查询"/>
            <Button fx:id="clearButton_Name" onAction="#removeAll" style="-fx-cursor: hand" text="清空列表"/>
            <Button fx:id="exportButton_Name" onAction="#exportAll" styleClass="cornflowerblue-button" text="开始导出"/>

            <Label fx:id="fileNumber_Name" alignment="CENTER_RIGHT" prefHeight="20" text="列表为空"/>
        </HBox>

        <TableView fx:id="tableView_Name" onDragDropped="#handleDrop" onDragOver="#acceptDrop">
            <placeholder>
                <Label text="拖拽 或点击 选择要读取的文件夹 按钮向列表添加文件"/>
            </placeholder>

            <columns>
                <TableColumn fx:id="index_Name" text="行号" sortable="false"/>
                <TableColumn fx:id="id_Name" text="序号"/>
                <TableColumn fx:id="thumb_Name" text="缩略图" sortable="false"/>
                <TableColumn fx:id="name_Name" text="文件名称"/>
                <TableColumn fx:id="fileType_Name" text="文件类型"/>
                <TableColumn fx:id="path_Name" text="文件路径"/>
                <TableColumn fx:id="size_Name" sortType="DESCENDING" text="文件大小"/>
                <TableColumn fx:id="showStatus_Name" text="是否隐藏"/>
                <TableColumn fx:id="creatDate_Name" text="创建时间"/>
                <TableColumn fx:id="updateDate_Name" text="修改时间"/>
            </columns>
        </TableView>

        <HBox fx:id="tipHBox_Name" spacing="10">
            <ProgressBar fx:id="progressBar_Name" visible="false" prefWidth="200.0" progress="0.0"/>
            <Label fx:id="tip_Name" prefHeight="20" textFill="red" alignment="CENTER_RIGHT"
                   text="读取数据后上下拖拽数据行可调整数据顺序，右键点击数据行可进行调整操作，按住shift可多选"/>
        </HBox>

        <Label fx:id="log_Name" prefHeight="20"/>
    </VBox>
</AnchorPane>
